# <!-- Powered by BMADâ„¢ Core -->

## Status
to be done later

## Story
**As a** mobile user,
**I want** a bottom tab navigation bar with Chat, Agents, and Logs tabs,
**so that** I can easily switch between different panels on small screens

## Acceptance Criteria
1. Tab bar renders on screens < 768px width
2. Three tabs are present: Chat (ðŸ’¬), Agents (ðŸ¤–), and Logs (ðŸ“‹)
3. Active tab is highlighted with primary color (cyan)
4. Tapping a tab switches the visible panel (full-screen display)
5. Only one panel is visible at a time on mobile
6. Desktop layout unchanged (three panels remain side-by-side at â‰¥768px)
7. Footer stats bar remains responsive (stacks on mobile)
8. No horizontal scroll on 320px width (iPhone SE)
9. Tab bar uses semantic HTML with proper ARIA labels
10. Keyboard navigation works (Arrow keys switch tabs)

## Tasks / Subtasks

- [ ] Task 1: Create mobile breakpoint detection hook (AC: 1, 5)
  - [ ] Create `hooks/use-mobile.ts` file
  - [ ] Implement window resize listener with 768px breakpoint
  - [ ] Add cleanup to prevent memory leaks
  - [ ] Export `useMobile()` hook that returns boolean
  - [ ] Write unit tests for hook with mocked window.innerWidth

- [ ] Task 2: Create TabNavigation component (AC: 2, 3, 4, 9, 10)
  - [ ] Create `components/mobile/tab-navigation.tsx` file
  - [ ] Define TABS constant with 3 tab configurations (id, label, icon)
  - [ ] Implement component with role="tablist" and proper ARIA attributes
  - [ ] Add active tab highlighting using primary color design token
  - [ ] Implement keyboard navigation (ArrowLeft, ArrowRight)
  - [ ] Add focus management for accessibility
  - [ ] Style with Tailwind classes using design tokens
  - [ ] Write unit tests for component rendering and interactions

- [ ] Task 3: Create TabPanel wrapper component (AC: 5)
  - [ ] Create `components/mobile/tab-panel.tsx` file
  - [ ] Implement conditional rendering based on active tab
  - [ ] Add role="tabpanel" with aria-labelledby attribute
  - [ ] Ensure full-screen display on mobile (h-full, w-full)
  - [ ] Write unit tests for panel visibility logic

- [ ] Task 4: Update page layout to use mobile tabs (AC: 1, 6, 7)
  - [ ] Import useMobile hook in `app/page.tsx`
  - [ ] Add tab state management (useState for activeTab)
  - [ ] Conditionally render TabNavigation on mobile
  - [ ] Keep ThreePanelLayout rendering on desktop
  - [ ] Update footer to be responsive (stack items on mobile)
  - [ ] Test layout transitions at 768px breakpoint

- [ ] Task 5: Ensure no horizontal scroll on small screens (AC: 8)
  - [ ] Add overflow-x-hidden to mobile container
  - [ ] Test on 320px viewport (Chrome DevTools iPhone SE)
  - [ ] Verify tab labels fit without wrapping
  - [ ] Ensure touch targets are minimum 44px (iOS HIG)

- [ ] Task 6: Add integration tests (AC: All)
  - [ ] Test tab switching on mobile viewport
  - [ ] Test desktop layout unchanged
  - [ ] Test keyboard navigation through tabs
  - [ ] Test accessibility with screen reader (manual)
  - [ ] Verify no console errors or warnings

## Dev Notes

### Previous Story Insights
From Story 1.10 (Create Mobile Responsive Layout):
- Mobile layout already implements tab switching for panels
- Collapsible panel functionality from Story 1.8 should be preserved on desktop
- Design tokens system is fully implemented and should be used for all styling
- Footer component already exists and needs responsive adjustments

### Mobile Breakpoint Strategy
**[Source: architecture/9-frontend-architecture.md#9.4]**
- Use Tailwind breakpoints: mobile (0-767px), tablet (768-1023px), desktop (1024px+)
- Use `md:` prefix for tablet/desktop styles
- Mobile-first approach: default styles for mobile, add `md:` for larger screens

### Component Structure
**[Source: architecture/9-frontend-architecture.md#9.1]**
- New directory: `orchestratai_client/src/components/mobile/`
- Files to create:
  - `tab-navigation.tsx` - Bottom tab bar component
  - `tab-panel.tsx` - Tab content wrapper
- Location for hook: `orchestratai_client/src/hooks/use-mobile.ts`

### Design Tokens to Use
**[Source: docs/architecture/source-tree.md, Story 1.2]**
- Primary color (cyan): `var(--color-primary)` for active tab
- Text colors: `var(--color-text-primary)`, `var(--color-text-secondary)`, `var(--color-text-tertiary)`
- Spacing: Use `var(--spacing-*)` tokens (xs, sm, md, lg, xl)
- Border radius: `var(--radius-md)` for tab buttons
- Shadow: `var(--shadow-md)` for elevated tab bar

### State Management Pattern
**[Source: architecture/9-frontend-architecture.md#9.2]**
- Use React useState for local tab state (simple component state)
- Pattern: `const [activeTab, setActiveTab] = useState<'chat' | 'agents' | 'logs'>('chat')`
- No need for Context - tab state is UI-only, not shared globally

### Icons Library
**[Source: architecture/3-tech-stack.md]**
- Use Lucide React for icons (already installed)
- Import: `import { MessageSquare, Users, FileText } from 'lucide-react'`
- Icons should be 20px (size={20}) for tab bar

### Accessibility Requirements
**[Source: Epic 4 spec]**
- Tab bar: `role="tablist"`
- Individual tabs: `role="tab"`, `aria-selected="true|false"`, `aria-controls="{panel-id}"`
- Tab panels: `role="tabpanel"`, `aria-labelledby="{tab-id}"`
- Keyboard navigation: Arrow keys (Left/Right) to switch tabs, Enter/Space to activate
- Focus management: Move focus to newly activated tab

### Responsive Behavior
**[Source: Epic 4 spec, AC]**
- Tab bar visibility: `className="lg:hidden"` (hide on desktop â‰¥1024px)
- Desktop layout: `className="hidden lg:grid lg:grid-cols-[250px_1fr_300px]"` (3-panel grid on desktop)
- Fixed positioning for tab bar: `className="fixed bottom-0 left-0 right-0 z-10 bg-background border-t"`
- Add bottom padding to main content to prevent tab bar overlap

### Touch Target Sizing
**[Source: iOS Human Interface Guidelines]**
- Minimum touch target: 44px Ã— 44px
- Tab buttons should be at least 44px tall
- Horizontal spacing between tabs for comfortable tapping

### Testing

**[Source: architecture/15-testing-strategy.md]**

**Test File Locations:**
- `orchestratai_client/src/hooks/__tests__/use-mobile.test.ts`
- `orchestratai_client/src/components/mobile/__tests__/tab-navigation.test.tsx`
- `orchestratai_client/src/components/mobile/__tests__/tab-panel.test.tsx`

**Testing Framework:**
- Vitest for unit tests
- React Testing Library for component tests
- Use `@testing-library/user-event` for interaction testing

**Test Coverage Requirements:**
- Minimum 90% coverage required
- Test all interactive behaviors (click, keyboard)
- Test responsive breakpoints (mock window.innerWidth)
- Test accessibility attributes

**Example Test Structure:**
```typescript
describe('TabNavigation', () => {
  it('renders all three tabs', () => {
    render(<TabNavigation activeTab="chat" onTabChange={jest.fn()} />);
    expect(screen.getByRole('tab', { name: /chat/i })).toBeInTheDocument();
    expect(screen.getByRole('tab', { name: /agents/i })).toBeInTheDocument();
    expect(screen.getByRole('tab', { name: /logs/i })).toBeInTheDocument();
  });

  it('highlights active tab', () => {
    render(<TabNavigation activeTab="agents" onTabChange={jest.fn()} />);
    const agentsTab = screen.getByRole('tab', { name: /agents/i });
    expect(agentsTab).toHaveAttribute('aria-selected', 'true');
  });

  it('calls onTabChange when tab clicked', async () => {
    const handleChange = jest.fn();
    render(<TabNavigation activeTab="chat" onTabChange={handleChange} />);

    const agentsTab = screen.getByRole('tab', { name: /agents/i });
    await userEvent.click(agentsTab);

    expect(handleChange).toHaveBeenCalledWith('agents');
  });
});
```

### Styling Standards
**[Source: architecture/16-coding-standards.md]**
- Use design token classes ONLY - NO arbitrary Tailwind values
- Component naming: PascalCase (TabNavigation.tsx)
- CSS classes: Use `cn()` utility for conditional classes
- Never use inline styles - use Tailwind classes with design tokens

### Component Organization
**[Source: architecture/source-tree.md]**
```
orchestratai_client/src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ mobile/              # NEW
â”‚       â”œâ”€â”€ tab-navigation.tsx
â”‚       â”œâ”€â”€ tab-panel.tsx
â”‚       â””â”€â”€ __tests__/
â”‚           â”œâ”€â”€ tab-navigation.test.tsx
â”‚           â””â”€â”€ tab-panel.test.tsx
â””â”€â”€ hooks/
    â”œâ”€â”€ use-mobile.ts        # NEW
    â””â”€â”€ __tests__/
        â””â”€â”€ use-mobile.test.ts
```

### Integration Points
**[Source: Epic 4 spec, Epic 1]**
- Integrates with existing ThreePanelLayout from Story 1.7
- Uses CollapsiblePanel from Story 1.8 on desktop
- Footer from Story 1.9 needs responsive updates
- Chat panel from Epic 2 (ChatInterface component)
- Agent panel from Epic 3 (AgentPanel component)
- Log panel from Epic 3 (RetrievalPanel component)

### Performance Considerations
- Debounce window resize listener (300ms) to avoid excessive re-renders
- Use `useCallback` for tab change handler to prevent unnecessary child re-renders
- Lazy load panel content if needed (Future optimization)

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-01 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
<!-- To be filled by Dev Agent -->

### Debug Log References
<!-- To be filled by Dev Agent -->

### Completion Notes List
<!-- To be filled by Dev Agent -->

### File List
<!-- To be filled by Dev Agent -->

## QA Results
<!-- To be filled by QA Agent -->
