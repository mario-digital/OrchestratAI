# <!-- Powered by BMADâ„¢ Core -->

## Status
Draft

## Story
**As a** developer exploring OrchestratAI,
**I want** detailed documentation for components and API endpoints,
**so that** I can understand how to use, extend, or integrate with the system

## Acceptance Criteria
1. Component documentation created for 5+ major components
2. Each component doc includes: Overview, Props table, Usage example, Design tokens used
3. API documentation includes all endpoints with request/response examples
4. Create `docs/components/README.md` as component library index
5. Create `docs/api/README.md` as API reference
6. Document at least: AgentCard, MessageBubble, ChatInterface, CollapsiblePanel, TabNavigation
7. API docs include: POST /api/chat, POST /api/chat/stream, GET /api/session/{id}
8. All code examples syntax highlighted and tested
9. Props documented with TypeScript types
10. Response schemas shown in JSON format
11. Error codes documented with descriptions
12. Links from main README to component/API docs work

## Tasks / Subtasks

- [ ] Task 1: Create component documentation template (AC: 2)
  - [ ] Create `docs/components/` directory
  - [ ] Design standard component doc template with sections:
    - Overview with component purpose
    - Location (file path)
    - Added in (story reference)
    - Dependencies list
    - Props table (name, type, required, default, description)
    - Usage example with imports
    - Design tokens used section
    - States section (if stateful)
    - Animations section (if animated)
    - Accessibility section
    - Related components
  - [ ] Create template as `docs/components/_template.md`
  - [ ] Test template with one component example

- [ ] Task 2: Document AgentCard component (AC: 1, 6, from Story 3.3)
  - [ ] Read `orchestratai_client/src/components/panels/agent-card.tsx`
  - [ ] Extract prop types from component definition
  - [ ] Create `docs/components/agent-card.md`
  - [ ] Write overview describing multi-agent status display
  - [ ] Document all props with TypeScript types:
    - agent: AgentId
    - status: AgentStatus
    - model: string
    - strategy: StrategyType
    - metrics: AgentMetrics
    - cacheStatus: 'hit' | 'miss' | 'none'
    - onViewGraph: () => void
  - [ ] Provide usage example with sample props
  - [ ] List design tokens: agent colors, status colors, spacing, radius, shadow
  - [ ] Document 4 states: IDLE, ROUTING, ACTIVE, COMPLETE
  - [ ] Document animations: hover effect, status pulse
  - [ ] Document accessibility attributes
  - [ ] List related components: AgentPanel, AgentStatusBadge, AgentMetrics

- [ ] Task 3: Document MessageBubble component (AC: 1, 6, from Story 2.5)
  - [ ] Read `orchestratai_client/src/components/chat/message-bubble.tsx`
  - [ ] Create `docs/components/message-bubble.md`
  - [ ] Document props:
    - message: Message object
    - role: 'USER' | 'ASSISTANT'
    - timestamp: string (ISO 8601)
    - isStreaming: boolean (optional)
  - [ ] Provide usage examples for both USER and ASSISTANT roles
  - [ ] List design tokens: message colors, spacing, radius, typography
  - [ ] Document markdown rendering (if supported)
  - [ ] Document accessibility: role="article", aria-label
  - [ ] Add code syntax highlighting example (if supported)

- [ ] Task 4: Document ChatInterface component (AC: 1, 6, from Story 2.8)
  - [ ] Read `orchestratai_client/src/components/chat/chat-interface.tsx`
  - [ ] Create `docs/components/chat-interface.md`
  - [ ] Document props (likely none or minimal - uses context)
  - [ ] Explain integration with ChatProvider context
  - [ ] Document child components:
    - MessageList
    - ChatInput
    - ClearHistoryButton
  - [ ] Provide usage example showing context wrapper
  - [ ] Document scrolling behavior (auto-scroll to bottom)
  - [ ] Document loading states (typing indicator)
  - [ ] List design tokens used
  - [ ] Document keyboard shortcuts (Enter to send)

- [ ] Task 5: Document CollapsiblePanel component (AC: 1, 6, from Story 1.8)
  - [ ] Read `orchestratai_client/src/components/layout/collapsible-panel.tsx`
  - [ ] Create `docs/components/collapsible-panel.md`
  - [ ] Document props:
    - title: string
    - children: ReactNode
    - defaultOpen: boolean
    - onToggle: (isOpen: boolean) => void
  - [ ] Provide usage example wrapping content
  - [ ] Document collapse/expand animation (Framer Motion)
  - [ ] Document icon rotation (chevron)
  - [ ] List design tokens: border, spacing, transitions
  - [ ] Document accessibility: button role, aria-expanded

- [ ] Task 6: Document TabNavigation component (AC: 1, 6, from Story 4.1)
  - [ ] Read `orchestratai_client/src/components/mobile/tab-navigation.tsx`
  - [ ] Create `docs/components/tab-navigation.md`
  - [ ] Document props:
    - tabs: Array<{ id: string; label: string; icon: ReactNode }>
    - activeTab: string
    - onTabChange: (tabId: string) => void
  - [ ] Provide usage example with Chat, Agents, Logs tabs
  - [ ] Document mobile-only display (< 768px)
  - [ ] Document swipe gesture support (from Story 4.2)
  - [ ] List design tokens: tab colors, active indicator, spacing
  - [ ] Document accessibility: role="tablist", aria-selected

- [ ] Task 7: Create component library index (AC: 4)
  - [ ] Create `docs/components/README.md`
  - [ ] Write introduction to OrchestratAI components
  - [ ] List all documented components with descriptions
  - [ ] Organize by category:
    - Layout: CollapsiblePanel, TabNavigation
    - Chat: ChatInterface, MessageBubble
    - Panels: AgentCard, AgentPanel, LogPanel
  - [ ] Link to each component's documentation file
  - [ ] Add "How to Use This Documentation" section
  - [ ] Include link back to main README

- [ ] Task 8: Create API documentation structure (AC: 3, 5)
  - [ ] Create `docs/api/` directory
  - [ ] Create `docs/api/README.md` as API reference index
  - [ ] Write introduction to OrchestratAI API
  - [ ] List all endpoints with brief descriptions
  - [ ] Include base URL: http://localhost:8000
  - [ ] Document authentication (if applicable)
  - [ ] Document common headers
  - [ ] Document error response format
  - [ ] Add link to OpenAPI docs (http://localhost:8000/docs)

- [ ] Task 9: Document chat endpoints (AC: 7)
  - [ ] Create `docs/api/chat-endpoints.md`
  - [ ] Document POST /api/chat endpoint:
    - Request schema (ChatRequest)
    - Response schema (ChatResponse)
    - Request example (curl and TypeScript)
    - Response example (JSON)
    - Error codes: 400 (bad request), 500 (server error)
  - [ ] Document POST /api/chat/stream endpoint:
    - Request schema (same as /api/chat)
    - SSE event types: agent_status, message_chunk, done
    - Event data schemas
    - JavaScript EventSource example
    - Error handling example
  - [ ] Test all examples by running them
  - [ ] Add notes on differences between streaming and non-streaming

- [ ] Task 10: Document session endpoints (AC: 7)
  - [ ] Create `docs/api/session-endpoints.md`
  - [ ] Document GET /api/session/{session_id} endpoint:
    - Path parameter: session_id (UUID)
    - Response schema (SessionData)
    - Response example with message history
    - Error codes: 404 (not found), 500 (server error)
  - [ ] Document DELETE /api/session/{session_id} endpoint:
    - Path parameter: session_id (UUID)
    - Response (204 No Content)
    - Error codes: 404 (not found)
  - [ ] Add curl and TypeScript examples for both
  - [ ] Test all examples

- [ ] Task 11: Update main README with documentation links (AC: 12)
  - [ ] Add "Documentation" section to main README
  - [ ] Link to Component Documentation (docs/components/README.md)
  - [ ] Link to API Documentation (docs/api/README.md)
  - [ ] Add table of contents link for easy navigation
  - [ ] Test all links work (relative paths)
  - [ ] Ensure links work on GitHub

- [ ] Task 12: Review and finalize all documentation (AC: 8, 9, 10, 11)
  - [ ] Verify all code examples are syntax highlighted (markdown ```typescript, ```json, ```bash)
  - [ ] Test all TypeScript examples compile
  - [ ] Test all curl examples return expected responses
  - [ ] Verify all prop types match actual component code
  - [ ] Check all JSON schemas are valid
  - [ ] Ensure consistent formatting across all docs
  - [ ] Spell check all documentation
  - [ ] Verify all internal links work
  - [ ] Get peer review on clarity and completeness

## Dev Notes

### Previous Story Context
This story builds upon all previous stories across Epics 1-5, as it documents the components and APIs created throughout the project. Key stories referenced:
- **Story 1.8**: CollapsiblePanel component (layout foundation)
- **Story 2.5**: MessageBubble component (chat rendering)
- **Story 2.8**: ChatInterface component (chat orchestration)
- **Story 3.3**: AgentCard component (agent status display)
- **Story 4.1**: TabNavigation component (mobile navigation)

### Architecture References

**Documentation Structure** [Source: 6-documentation-deployment.md#story-6.2]
- Component docs organized by category (Layout, Chat, Panels)
- API docs organized by resource (Chat, Session)
- Index files for easy navigation
- Consistent template for all component docs

**Component Documentation Template** [Source: summary]
Each component doc should include:
1. **Overview**: Purpose and use case
2. **Location**: File path in codebase
3. **Added in**: Story reference for traceability
4. **Dependencies**: External libraries used
5. **Props**: Complete TypeScript interface with descriptions
6. **Usage**: Import statement and JSX example
7. **Design Tokens**: CSS custom properties used
8. **States**: Visual states and when they occur
9. **Animations**: Framer Motion variants or transitions
10. **Accessibility**: ARIA attributes and keyboard support
11. **Related Components**: Connected components

**API Documentation Template** [Source: summary]
Each endpoint doc should include:
1. **HTTP Method + Path**: e.g., POST /api/chat
2. **Description**: What the endpoint does
3. **Request**:
   - Headers required
   - Body schema (TypeScript interface)
   - Body example (JSON)
4. **Response**:
   - Status codes
   - Body schema (TypeScript interface)
   - Body example (JSON)
5. **Error Responses**:
   - Error codes with descriptions
   - Error response examples
6. **Examples**:
   - curl command
   - TypeScript/JavaScript fetch example

### Code Examples

**Component Documentation Example** (AgentCard):
```markdown
# AgentCard Component

## Overview
Displays individual agent status, metrics, and visual indicators for the multi-agent orchestration system.

**Location:** `orchestratai_client/src/components/panels/agent-card.tsx`
**Added in:** Story 3.3
**Dependencies:** Framer Motion, shadcn/ui Badge

## Props

| Prop | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| agent | `AgentId` | Yes | - | Agent identifier (ORCHESTRATOR, BILLING, TECHNICAL, POLICY) |
| status | `AgentStatus` | Yes | - | Current status (IDLE, ROUTING, ACTIVE, COMPLETE) |
| model | `string` | Yes | - | LLM model name (e.g., "OpenAI GPT-4o") |
| strategy | `StrategyType` | Yes | - | Retrieval strategy (RAG, CAG, HYBRID) |
| metrics | `AgentMetrics` | Yes | - | Usage metrics (tokens, cost, latency) |
| cacheStatus | `'hit' \| 'miss' \| 'none'` | No | `'none'` | Cache operation status |
| onViewGraph | `() => void` | No | - | Callback for execution graph view |

## Usage

```typescript
import { AgentCard } from '@/components/panels/agent-card';
import { AgentId, AgentStatus, StrategyType } from '@/lib/enums';

<AgentCard
  agent={AgentId.BILLING}
  status={AgentStatus.ACTIVE}
  model="OpenAI GPT-4o"
  strategy={StrategyType.RAG}
  metrics={{
    tokens: 450,
    cost: 0.0023,
    latency: 1200,
  }}
  cacheStatus="hit"
/>
```

## Design Tokens Used

- `--color-agent-billing` - Agent-specific color (green)
- `--color-status-active` - Active status color
- `--spacing-md` - Card padding
- `--radius-md` - Border radius
- `--shadow-md` - Card elevation

## States

1. **IDLE**: Gray background, no pulse animation
2. **ROUTING**: Cyan background with pulse (Orchestrator only)
3. **ACTIVE**: Colored background matching agent, pulse animation
4. **COMPLETE**: Colored background, no animation

## Animations

- Hover effect: Scale 1.02, shadow increase (Story 5.2)
- Status pulse: Opacity 0.7 â†’ 1.0 loop (2s duration)

## Accessibility

- `role="article"` on card container
- `aria-label` describes agent and status
- Status badge has `aria-live="polite"` for updates

## Related Components

- **AgentPanel**: Container for all agent cards (Story 3.5)
- **AgentStatusBadge**: Status indicator subcomponent (Story 3.3)
- **AgentMetrics**: Metrics display subcomponent (Story 3.4)
```

**API Documentation Example** (POST /api/chat):
```markdown
# Chat API Endpoints

## POST /api/chat

Send a message and receive a response from the orchestrated agent system.

### Request

**URL:** `POST http://localhost:8000/api/chat`

**Headers:**
```json
{
  "Content-Type": "application/json"
}
```

**Body:**
```json
{
  "message": "What are your pricing tiers?",
  "session_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

**Schema:**
```typescript
interface ChatRequest {
  message: string;        // User message content (1-2000 chars)
  session_id: string;     // UUID v4 session identifier
}
```

### Response

**Status:** `200 OK`

**Body:**
```json
{
  "message": {
    "role": "ASSISTANT",
    "content": "We offer three pricing tiers...",
    "timestamp": "2025-11-01T12:00:00Z"
  },
  "agent": "BILLING",
  "agent_status": {
    "ORCHESTRATOR": "IDLE",
    "BILLING": "COMPLETE",
    "TECHNICAL": "IDLE",
    "POLICY": "IDLE"
  },
  "metrics": {
    "tokens_used": 450,
    "cost_usd": 0.0023,
    "latency_ms": 1200,
    "cache_status": "hit"
  },
  "retrieval_logs": [
    {
      "type": "query_analysis",
      "timestamp": "2025-11-01T11:59:58Z",
      "data": {
        "intent": "Billing inquiry detected",
        "confidence": 0.95,
        "target_agent": "BILLING"
      }
    }
  ]
}
```

### Error Responses

**400 Bad Request** - Invalid request format
```json
{
  "detail": "Message too long (max 2000 characters)"
}
```

**500 Internal Server Error** - Server error
```json
{
  "detail": "Internal server error"
}
```

### Example (curl)

```bash
curl -X POST http://localhost:8000/api/chat \
  -H "Content-Type": "application/json" \
  -d '{
    "message": "What are your pricing tiers?",
    "session_id": "550e8400-e29b-41d4-a716-446655440000"
  }'
```

### Example (TypeScript)

```typescript
import { sendChatMessage } from '@/lib/api/chat';

const response = await sendChatMessage(
  'What are your pricing tiers?',
  sessionId
);

console.log(response.message.content);
console.log(response.agent); // "BILLING"
```
```

**Component Library Index** (docs/components/README.md):
```markdown
# OrchestratAI Component Library

This directory contains detailed documentation for all React components in the OrchestratAI application.

## How to Use This Documentation

Each component page includes:
- **Overview**: Purpose and use case
- **Props**: Complete TypeScript interface
- **Usage**: Code examples with imports
- **Design Tokens**: CSS variables used
- **Accessibility**: ARIA attributes and keyboard support

## Components by Category

### Layout Components
- [CollapsiblePanel](./collapsible-panel.md) - Expandable/collapsible container with animation
- [TabNavigation](./tab-navigation.md) - Mobile bottom tab bar with swipe support

### Chat Components
- [ChatInterface](./chat-interface.md) - Main chat orchestration component
- [MessageBubble](./message-bubble.md) - Individual message display (user/assistant)

### Panel Components
- [AgentCard](./agent-card.md) - Agent status, metrics, and visual indicators
- [AgentPanel](./agent-panel.md) - Container for all agent cards
- [LogPanel](./log-panel.md) - Retrieval log display with collapsible entries

## Design System

All components use the 3-layer CSS token system:
- **Core tokens**: `--color-*`, `--spacing-*`, `--radius-*`, `--shadow-*`
- **Semantic tokens**: `--color-agent-*`, `--color-status-*`
- **Component tokens**: Component-specific overrides

See [globals.css](../../orchestratai_client/src/app/globals.css) for full token reference.

## Contributing

When documenting new components, use the [template](./_template.md) for consistency.
```

**API Reference Index** (docs/api/README.md):
```markdown
# OrchestratAI API Reference

This directory contains detailed documentation for all FastAPI endpoints in the OrchestratAI backend.

## Base URL

**Local Development:** `http://localhost:8000`
**Production:** (TBD after deployment)

## Interactive Documentation

FastAPI provides interactive API docs at:
- **Swagger UI:** http://localhost:8000/docs
- **ReDoc:** http://localhost:8000/redoc

## Available Endpoints

### Chat Endpoints
- [POST /api/chat](./chat-endpoints.md#post-apichat) - Send message (non-streaming)
- [POST /api/chat/stream](./chat-endpoints.md#post-apichatstream) - Send message (SSE streaming)

### Session Endpoints
- [GET /api/session/{session_id}](./session-endpoints.md#get-apisessionsession_id) - Retrieve session data
- [DELETE /api/session/{session_id}](./session-endpoints.md#delete-apisessionsession_id) - Clear session

## Common Headers

All requests should include:
```json
{
  "Content-Type": "application/json"
}
```

## Error Response Format

All errors follow this schema:
```json
{
  "detail": "Error message description"
}
```

## HTTP Status Codes

- `200 OK` - Successful request
- `204 No Content` - Successful deletion
- `400 Bad Request` - Invalid request parameters
- `404 Not Found` - Resource not found
- `500 Internal Server Error` - Server error
```

### File Structure
```
docs/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ README.md               # Component library index
â”‚   â”œâ”€â”€ _template.md           # Component doc template
â”‚   â”œâ”€â”€ agent-card.md          # AgentCard docs
â”‚   â”œâ”€â”€ message-bubble.md      # MessageBubble docs
â”‚   â”œâ”€â”€ chat-interface.md      # ChatInterface docs
â”‚   â”œâ”€â”€ collapsible-panel.md   # CollapsiblePanel docs
â”‚   â””â”€â”€ tab-navigation.md      # TabNavigation docs
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ README.md              # API reference index
â”‚   â”œâ”€â”€ chat-endpoints.md      # Chat endpoint docs
â”‚   â””â”€â”€ session-endpoints.md   # Session endpoint docs
â””â”€â”€ images/
    â””â”€â”€ (screenshots from Story 6.1)
```

### Integration Points
- Link from main README â†’ docs/components/README.md
- Link from main README â†’ docs/api/README.md
- Component docs reference story numbers for traceability
- API docs tested against running backend
- Code examples validated with TypeScript compiler

### Testing Requirements
- **Unit Tests**: Not applicable (documentation only)
- **Integration Tests**: Verify all code examples compile/run
- **Manual Tests**:
  - All curl examples return expected responses
  - All TypeScript examples type-check successfully
  - All links navigate correctly
  - Documentation renders properly on GitHub

### Performance Considerations
- Keep documentation files under 500 lines each
- Optimize code examples (concise but complete)
- Use syntax highlighting for better readability
- Link to external resources rather than duplicating

### Accessibility Guidelines
- Use proper markdown heading hierarchy (h1 â†’ h2 â†’ h3)
- Provide alt text for any diagrams (if added)
- Use semantic markdown (code blocks, tables, lists)
- Ensure code examples are screen-reader friendly

### Browser Compatibility
- Documentation should render on GitHub (GFM - GitHub Flavored Markdown)
- Test links work in GitHub web interface
- Verify code blocks render with syntax highlighting

## Change Log
- 2025-11-01: Story created (Draft status)

---

## Dev Agent Record

### Agent Session 1
**Date:** _YYYY-MM-DD_
**Agent:** _Agent Name/ID_
**Task:** _Which task(s) were worked on_

**Changes Made:**
- _Bullet list of changes_

**Challenges:**
- _Any issues encountered_

**Status:** _Task completion status_

---

## QA Results

### Test Session 1
**Date:** _YYYY-MM-DD_
**Tester:** _Tester Name_
**Build:** _Version/commit hash_

**Test Results:**
- [ ] All acceptance criteria met
- [ ] Code examples tested and working
- [ ] Links verified
- [ ] No spelling/grammar errors

**Bugs Found:**
- _List any issues_

**Status:** â¬œ Not Tested | ðŸŸ¡ In Progress | ðŸŸ¢ Passed | ðŸ”´ Failed
